{% set version = "2.1.4" %}

package:
  name: libjpeg-turbo
  version: {{ version }}

source:
  url: https://github.com/libjpeg-turbo/libjpeg-turbo/archive/{{ version }}.tar.gz
  sha256: a78b05c0d8427a90eb5b4eb08af25309770c8379592bb0b8a863373128e6143f

build:
  number: 1

requirements:
  build:
    - {{ compiler('c') }}
    - cmake
    - make
    - yasm

outputs:
  - name: libjpeg-turbo
    build:
      run_exports:
      - {{ pin_subpackage('libjpeg-turbo', max_pin='x') }}
    requirements:
      build:
        - {{ compiler('c') }}
        - cmake
        - make
        - msinttypes  # [win and py<35]
        - yasm
        - jom  # [win]

    test:
      files:
        - testorig.jpg
      commands:
        - djpeg -dct int -ppm -outfile testout.ppm testorig.jpg

    about:
      summary: IJG JPEG compliant runtime library with SIMD and other optimizations

  - name: jpeg
    version: 8d
    build:
      run_exports:
        - {{ pin_subpackage('jpeg') }}
      track_features:
        - jpeg_impl_libjpeg_turbo
    requirements:
      run:
        - {{ pin_subpackage('libjpeg-turbo', exact=True) }}
    about:
      summary: jpeg virtual package

about:
  home: http://www.libjpeg-turbo.org/
  license: IJG, modified 3-clause BSD and zlib
  license_file: LICENSE.md
  summary: IJG JPEG compliant runtime library with SIMD and other optimizations

extra:
  recipe-maintainers:
    - valgur
    - sdvillal
    - carlodri
